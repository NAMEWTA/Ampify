import * as vscode from 'vscode';

export type Lang = 'en' | 'zh-cn';

const translations = {
    'en': {
        'copier.noFilePath': 'Unable to get file path',
        'copier.copied': 'Copied: "{0}"',
        'launcher.noInstances': 'No accounts available',
        'launcher.addInstancePlaceholder': 'Click + above to add a new instance',
        'launcher.inputKey': 'Enter unique identifier (key), e.g. "work"',
        'launcher.inputDirName': 'Enter data directory name (dirName), e.g. "github-work"',
        'launcher.inputDesc': 'Enter description',
        'launcher.confirmDelete': 'Are you sure you want to delete "{0}"?',
        'launcher.launchSuccess': 'Launched instance: {0}',
        'launcher.launchFail': 'Launch failed: {0}',
        'launcher.codeNotFound': 'Executable not found or launch failed. Please ensure VS Code is installed correctly.',
        'launcher.spawnError': 'Process launch error: {0}',
        // Skills Manager translations
        'skills.noSkills': 'No skills available',
        'skills.addSkillPlaceholder': 'Click + above to create a new skill',
        'skills.gitSettings': 'Git Settings',
        'skills.config': 'Config',
        'skills.skillsList': 'Skills',
        'skills.userName': 'User Name',
        'skills.userEmail': 'User Email',
        'skills.remoteUrl': 'Remote URL',
        'skills.gitStatus': 'Git Status',
        'skills.notConfigured': 'Not configured',
        'skills.inputSkillName': 'Enter skill name (lowercase, hyphens only)',
        'skills.inputSkillDesc': 'Enter skill description (what it does & when to use)',
        'skills.inputSkillVersion': 'Enter version (e.g. 1.0.0)',
        'skills.selectTags': 'Select tags (multiple)',
        'skills.addCustomTag': 'Add custom tag...',
        'skills.inputCustomTag': 'Enter custom tag',
        'skills.addPrerequisite': 'Add prerequisite?',
        'skills.selectPrereqType': 'Select prerequisite type',
        'skills.inputPrereqName': 'Enter prerequisite name (e.g. Node.js 18+)',
        'skills.inputCheckCommand': 'Enter check command (optional, e.g. node -v)',
        'skills.inputInstallHint': 'Enter install hint (optional)',
        'skills.addMorePrereq': 'Add another prerequisite?',
        'skills.skillCreated': 'Skill "{0}" created successfully',
        'skills.confirmDelete': 'Are you sure you want to delete skill "{0}"?',
        'skills.deleted': 'Skill "{0}" deleted',
        'skills.applied': 'Skill "{0}" applied to project',
        'skills.applyFailed': 'Failed to apply skill: {0}',
        'skills.removed': 'Skill "{0}" removed from project',
        'skills.pullSuccess': 'Successfully pulled from remote',
        'skills.pullFailed': 'Pull failed: {0}',
        'skills.pushSuccess': 'Successfully pushed to remote',
        'skills.pushFailed': 'Push failed: {0}',
        'skills.syncSuccess': 'Sync completed',
        'skills.syncFailed': 'Sync failed: {0}',
        'skills.localOnlyCommit': 'Local commit completed (no remote configured)',
        'skills.mergeConflict': 'Merge conflict detected. Please resolve conflicts before continuing.',
        'skills.noRemoteConfigured': 'No remote repository configured. Please configure Git remote URL first.',
        'skills.configureAuth': 'Push/Pull failed due to authentication. Please configure SSH Key or Personal Access Token.',
        'skills.hasUncommittedChanges': 'You have uncommitted changes. Please commit or stash them first.',
        'skills.inputUserName': 'Enter Git user name',
        'skills.inputUserEmail': 'Enter Git user email',
        'skills.inputRemoteUrl': 'Enter remote repository URL',
        'skills.inputRemoteUrls': 'Enter remote repository URLs (comma or line separated)',
        'skills.gitConfigUpdated': 'Git configuration updated',
        'skills.gitConfigOpened': 'Opened config.json. Edit gitConfig and save to apply.',
        'skills.searchPlaceholder': 'Search skills by name, description, or tags...',
        'skills.filterActive': 'Filter active: {0}',
        'skills.filterCleared': 'Filter cleared',
        'skills.noMatchingSkills': 'No skills match the filter',
        'skills.importSuccess': 'Skill "{0}" imported successfully',
        'skills.importFailed': 'Import failed: {0}',
        'skills.invalidSkillDir': 'Invalid skill directory. Must contain SKILL.md with valid frontmatter',
        'skills.skillExists': 'Skill "{0}" already exists',
        'skills.prerequisites': 'Prerequisites',
        'skills.version': 'Version',
        'skills.tags': 'Tags',
        'skills.checkPrerequisites': 'Checking prerequisites...',
        'skills.prerequisitesMet': 'All prerequisites met',
        'skills.prerequisitesNotMet': 'Some prerequisites not met:',
        'skills.diffTitle': '{0}: Local ↔ Remote',
        'skills.noChanges': 'No changes to show',
        'skills.changedFiles': '{0} file(s) changed',
        'skills.viewDiff': 'View Diff',
        'skills.confirmPull': 'Pull {0} changed file(s) from remote?',
        'skills.confirmPush': 'Push {0} changed file(s) to remote?',
        'skills.initialized': 'Skills Manager initialized',
        'skills.initFailed': 'Failed to initialize Skills Manager: {0}',
        'skills.runtime': 'Runtime',
        'skills.tool': 'Tool',
        'skills.extension': 'Extension',
        'skills.manual': 'Manual Step',
        'skills.nameValidation': 'Name must be lowercase letters, numbers, and hyphens only (max 64 chars)',
        'skills.descValidation': 'Description must be less than 1024 characters',
        'skills.yes': 'Yes',
        'skills.no': 'No',
        'skills.cancel': 'Cancel',
        'skills.openFolder': 'Open Folder',
        'skills.noWorkspace': 'No workspace folder open',
        'skills.syncToAgentMd': 'Sync AGENT.md',
        'skills.agentMdSynced': 'AGENT.md updated',
        // Commands Manager translations
        'commands.noCommands': 'No commands available',
        'commands.addCommandPlaceholder': 'Click + above to create a new command',
        'commands.commandsList': 'Commands',
        'commands.inputCommandName': 'Enter command name (lowercase, hyphens only)',
        'commands.inputCommandDesc': 'Enter command description',
        'commands.selectTags': 'Select tags (multiple)',
        'commands.addCustomTag': 'Add custom tag...',
        'commands.inputCustomTag': 'Enter custom tag',
        'commands.commandCreated': 'Command "{0}" created successfully',
        'commands.confirmDelete': 'Are you sure you want to delete command "{0}"?',
        'commands.deleted': 'Command "{0}" deleted',
        'commands.applied': 'Command "{0}" applied to project',
        'commands.applyFailed': 'Failed to apply command: {0}',
        'commands.removed': 'Command "{0}" removed from project',
        'commands.searchPlaceholder': 'Search commands by name, description, or tags...',
        'commands.filterActive': 'Filter active: {0}',
        'commands.filterCleared': 'Filter cleared',
        'commands.noMatchingCommands': 'No commands match the filter',
        'commands.importSuccess': 'Command "{0}" imported successfully',
        'commands.importFailed': 'Import failed: {0}',
        'commands.invalidCommandFile': 'Invalid command file. Must be .md with valid frontmatter (command, description, tags)',
        'commands.commandExists': 'Command "{0}" already exists',
        'commands.tags': 'Tags',
        'commands.nameValidation': 'Name must be lowercase letters, numbers, and hyphens only (max 64 chars)',
        'commands.descValidation': 'Description must be less than 1024 characters',
        'commands.fileNameMismatch': 'File name must match command field: {0}.md',
        'commands.openFolder': 'Open Folder',
        'commands.noWorkspace': 'No workspace folder open',
        'commands.initialized': 'Commands Manager initialized'
    },
    'zh-cn': {
        'copier.noFilePath': '无法获取文件路径',
        'copier.copied': '已复制："{0}"',
        'launcher.noInstances': '没有可用的账号',
        'launcher.addInstancePlaceholder': '点击上方 + 号添加新实例',
        'launcher.inputKey': '输入唯一标识 (key), 如 "work"',
        'launcher.inputDirName': '输入数据目录名 (dirName), 如 "github-work"',
        'launcher.inputDesc': '输入描述',
        'launcher.confirmDelete': '确定要删除 "{0}" 吗?',
        'launcher.launchSuccess': '已启动实例: {0}',
        'launcher.launchFail': '启动失败: {0}',
        'launcher.codeNotFound': '未找到可执行文件或启动失败。请确保 VS Code 安装正确。',
        'launcher.spawnError': '进程启动错误: {0}',
        // Skills Manager 翻译
        'skills.noSkills': '暂无可用技能',
        'skills.addSkillPlaceholder': '点击上方 + 号创建新技能',
        'skills.gitSettings': 'Git 设置',
        'skills.config': '配置',
        'skills.skillsList': '技能列表',
        'skills.userName': '用户名',
        'skills.userEmail': '用户邮箱',
        'skills.remoteUrl': '远程仓库',
        'skills.gitStatus': 'Git 状态',
        'skills.notConfigured': '未配置',
        'skills.inputSkillName': '输入技能名称（仅小写字母、数字和连字符）',
        'skills.inputSkillDesc': '输入技能描述（做什么 & 何时使用）',
        'skills.inputSkillVersion': '输入版本号（如 1.0.0）',
        'skills.selectTags': '选择标签（可多选）',
        'skills.addCustomTag': '添加自定义标签...',
        'skills.inputCustomTag': '输入自定义标签',
        'skills.addPrerequisite': '是否添加前置依赖？',
        'skills.selectPrereqType': '选择依赖类型',
        'skills.inputPrereqName': '输入依赖名称（如 Node.js 18+）',
        'skills.inputCheckCommand': '输入检测命令（可选，如 node -v）',
        'skills.inputInstallHint': '输入安装提示（可选）',
        'skills.addMorePrereq': '是否继续添加依赖？',
        'skills.skillCreated': '技能 "{0}" 创建成功',
        'skills.confirmDelete': '确定要删除技能 "{0}" 吗？',
        'skills.deleted': '技能 "{0}" 已删除',
        'skills.applied': '技能 "{0}" 已应用到项目',
        'skills.applyFailed': '应用技能失败：{0}',
        'skills.removed': '技能 "{0}" 已从项目移除',
        'skills.pullSuccess': '成功从远程拉取更新',
        'skills.pullFailed': '拉取失败：{0}',
        'skills.pushSuccess': '成功推送到远程',
        'skills.pushFailed': '推送失败：{0}',
        'skills.syncSuccess': '同步完成',
        'skills.syncFailed': '同步失败：{0}',
        'skills.localOnlyCommit': '仅本地提交，未配置远程仓库',
        'skills.mergeConflict': '检测到合并冲突，请先处理冲突后再继续。',
        'skills.noRemoteConfigured': '未配置远程仓库，请先配置 Git 远程地址。',
        'skills.configureAuth': '推送/拉取失败，认证错误。请配置 SSH Key 或 Personal Access Token。',
        'skills.hasUncommittedChanges': '存在未提交的更改，请先提交或暂存。',
        'skills.inputUserName': '输入 Git 用户名',
        'skills.inputUserEmail': '输入 Git 用户邮箱',
        'skills.inputRemoteUrl': '输入远程仓库地址',
        'skills.inputRemoteUrls': '输入远程仓库地址（逗号或换行分隔）',
        'skills.gitConfigUpdated': 'Git 配置已更新',
        'skills.gitConfigOpened': '已打开 config.json，请编辑 gitConfig 并保存后生效。',
        'skills.searchPlaceholder': '搜索技能（名称、描述或标签）...',
        'skills.filterActive': '过滤条件：{0}',
        'skills.filterCleared': '过滤已清除',
        'skills.noMatchingSkills': '没有匹配的技能',
        'skills.importSuccess': '技能 "{0}" 导入成功',
        'skills.importFailed': '导入失败：{0}',
        'skills.invalidSkillDir': '无效的技能目录，必须包含带有效 frontmatter 的 SKILL.md',
        'skills.skillExists': '技能 "{0}" 已存在',
        'skills.prerequisites': '前置依赖',
        'skills.version': '版本',
        'skills.tags': '标签',
        'skills.checkPrerequisites': '正在检查前置依赖...',
        'skills.prerequisitesMet': '所有依赖已满足',
        'skills.prerequisitesNotMet': '以下依赖未满足：',
        'skills.diffTitle': '{0}：本地 ↔ 远程',
        'skills.noChanges': '无变更',
        'skills.changedFiles': '{0} 个文件有变更',
        'skills.viewDiff': '查看差异',
        'skills.confirmPull': '是否拉取 {0} 个变更文件？',
        'skills.confirmPush': '是否推送 {0} 个变更文件？',
        'skills.initialized': 'Skills Manager 已初始化',
        'skills.initFailed': 'Skills Manager 初始化失败：{0}',
        'skills.runtime': '运行时',
        'skills.tool': '工具',
        'skills.extension': '扩展',
        'skills.manual': '手动步骤',
        'skills.nameValidation': '名称只能包含小写字母、数字和连字符（最多64字符）',
        'skills.descValidation': '描述不能超过1024个字符',
        'skills.yes': '是',
        'skills.no': '否',
        'skills.cancel': '取消',
        'skills.openFolder': '打开文件夹',
        'skills.noWorkspace': '未打开工作区文件夹',
        'skills.syncToAgentMd': '同步 AGENT.md',
        'skills.agentMdSynced': 'AGENT.md 已更新',
        // Commands Manager 翻译
        'commands.noCommands': '暂无可用命令',
        'commands.addCommandPlaceholder': '点击上方 + 号创建新命令',
        'commands.commandsList': '命令列表',
        'commands.inputCommandName': '输入命令名称（仅小写字母、数字和连字符）',
        'commands.inputCommandDesc': '输入命令描述',
        'commands.selectTags': '选择标签（可多选）',
        'commands.addCustomTag': '添加自定义标签...',
        'commands.inputCustomTag': '输入自定义标签',
        'commands.commandCreated': '命令 "{0}" 创建成功',
        'commands.confirmDelete': '确定要删除命令 "{0}" 吗？',
        'commands.deleted': '命令 "{0}" 已删除',
        'commands.applied': '命令 "{0}" 已应用到项目',
        'commands.applyFailed': '应用命令失败：{0}',
        'commands.removed': '命令 "{0}" 已从项目移除',
        'commands.searchPlaceholder': '搜索命令（名称、描述或标签）...',
        'commands.filterActive': '过滤条件：{0}',
        'commands.filterCleared': '过滤已清除',
        'commands.noMatchingCommands': '没有匹配的命令',
        'commands.importSuccess': '命令 "{0}" 导入成功',
        'commands.importFailed': '导入失败：{0}',
        'commands.invalidCommandFile': '无效的命令文件，必须是带有效 frontmatter（command、description、tags）的 .md 文件',
        'commands.commandExists': '命令 "{0}" 已存在',
        'commands.tags': '标签',
        'commands.nameValidation': '名称只能包含小写字母、数字和连字符（最多64字符）',
        'commands.descValidation': '描述不能超过1024个字符',
        'commands.fileNameMismatch': '文件名必须与 command 字段一致：{0}.md',
        'commands.openFolder': '打开文件夹',
        'commands.noWorkspace': '未打开工作区文件夹',
        'commands.initialized': 'Commands Manager 已初始化'
    }
};

export type TranslationKey = keyof typeof translations['en'];

export class I18n {
    static get(key: TranslationKey, ...args: string[]): string {
        const config = vscode.workspace.getConfiguration('ampify');
        const lang = config.get<Lang>('language') || 'zh-cn';
        
        const langData = translations[lang] || translations['zh-cn'];
        let template = langData[key as keyof typeof langData] || translations['en'][key as keyof typeof translations['en']] || key;
        
        args.forEach((arg, index) => {
            template = template.replace(`{${index}}`, arg);
        });
        
        return template;
    }
}
